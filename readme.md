# 开票金额拆分工具说明

该脚本用于将一个总金额 **N** 拆分为两张发票金额 **x** 和 **y**，同时满足下列业务约束：

1. **金额总和**：x + y = N。
2. **可整除性**：x、y 必须分别能够被质数集合 S = {2, 3, 5, 7, 11, 13, 17} 中 **至少 3 个不同质数** 整除。
   - 常见做法是让一张票含 S 中 3 个质数的因子，另一张票含剩余 4 个质数的因子。
   - 为对称考虑，也会枚举 "4 个质数 / 3 个质数" 的互换情况。

---

## 算法流程

| 步骤 | 说明 |
| ---- | ---- |
| 1 | **用户输入**：程序启动后提示输入正整数 `N`。 |
| 2 | **枚举质数分组**：对 S 做组合拆分，得到 `(Sₓ, Sᵧ)` = `(3 个质数, 4 个质数)` 和 `(4 个质数, 3 个质数)` 共 70 组组合。 |
| 3 | **计算最小公倍数**：对每个子集 Sᵢ 求最小公倍数 `mᵢ`（质数互质，LCM 为乘积）。 |
| 4 | **搜索解**：用 `y = mᵧ · j` (j ≥ 1) 枚举，令 `x = N − y`，若 `x > 0` 且 `x % mₓ == 0`，则 `(x, y)` 为候选解。 |
| 5 | **去重**：将 `(x, y)` 与 `(y, x)` 视为同一组，用键 `(min(x,y), max(x,y))` 过滤重复。 |
| 6 | **排序与推荐**：<br>① 先按 `|x − y|` 升序取前 10 名（金额差最小）；<br>② 再按 `x、y` 的质因数总个数降序重排，得到最终推荐列表。 |
| 7 | **输出**：显示 x、y 金额、对应质因数子集、完整质因数分解及排名指标。 |

---

## 使用示例
```bash
$ python number_de_structure.py
条件: x和y需分别被集合S中至少3个质数整除。
请输入一个正整数 N: 5954107

步骤1: 正在计算所有可能的解集...
计算完成！共找到 70 组解。
...
```
程序会列出满足条件、已去重并按优先级排序的拆分方案，供开票人员选择。

---

## 设计初衷

- **业务合规**：发票金额往往受税率/票种/系统校验规则限制，需要满足特定分母或公倍数。通过指定质数集合分解，可保证金额在后续折扣、退票、汇总时具有良好"可分性"。
- **操作便利**：优先推荐金额相近且因数丰富的解，方便企业遵循"拆分金额尽量平均"的习惯，并降低二次拆分难度。

---

> 如需调整质数集合或拆分张数，可在 `number_de_structure.py` 中修改 `S` 或扩展算法逻辑。
